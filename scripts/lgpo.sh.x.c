#if 0
	shc Version 3.8.9b, Generic Script Compiler
	Copyright (c) 1994-2015 Francisco Rosales <frosal@fi.upm.es>

	shc -r -f scripts/lgpo.sh 
#endif

static  char data [] = 
#define      lsto_z	1
#define      lsto	((&data[0]))
	"\103"
#define      xecc_z	15
#define      xecc	((&data[1]))
	"\342\203\336\143\031\024\102\133\063\101\226\111\350\304\202\275"
#define      msg2_z	19
#define      msg2	((&data[20]))
	"\241\023\362\101\112\321\017\053\375\165\327\165\202\310\065\072"
	"\033\114\225\367\202\324\320\265\264"
#define      opts_z	3
#define      opts	((&data[42]))
	"\246\032\137"
#define      tst1_z	22
#define      tst1	((&data[50]))
	"\130\150\105\337\172\351\327\066\330\144\304\313\141\004\117\242"
	"\037\003\325\262\245\146\353\323\321\254\202\213\257\004"
#define      chk1_z	22
#define      chk1	((&data[75]))
	"\311\315\133\073\226\326\105\266\006\233\352\117\014\233\120\046"
	"\377\140\306\244\156\071\273\206\055\006\103"
#define      text_z	1870
#define      text	((&data[454]))
	"\156\324\364\077\212\250\376\303\031\136\236\266\267\007\374\226"
	"\202\207\106\207\023\154\201\317\363\256\326\066\174\227\070\353"
	"\153\054\052\365\325\050\271\356\206\130\245\076\140\241\324\342"
	"\051\033\151\075\207\353\014\172\232\343\261\026\172\351\001\345"
	"\026\053\333\354\124\225\333\333\355\200\031\116\042\356\061\113"
	"\011\232\210\221\206\225\014\040\170\276\067\362\250\070\330\276"
	"\144\264\253\271\111\206\224\067\006\256\206\051\234\267\164\246"
	"\122\375\070\330\222\105\370\013\003\057\376\253\150\326\152\315"
	"\213\025\206\325\233\032\014\242\310\222\313\145\112\100\014\234"
	"\076\105\164\321\212\155\334\215\235\332\070\005\261\242\323\074"
	"\270\131\021\123\163\036\366\074\261\302\242\373\002\257\227\100"
	"\364\014\022\176\171\356\014\026\311\104\034\172\347\357\267\237"
	"\111\310\363\274\347\351\371\230\253\234\223\256\113\053\357\077"
	"\067\001\276\260\360\312\307\271\017\344\064\366\324\353\225\035"
	"\264\210\332\233\162\324\064\036\160\310\314\273\363\274\373\052"
	"\276\271\333\256\204\243\150\223\210\234\211\134\210\037\172\074"
	"\250\124\330\032\050\014\070\231\324\005\124\307\301\117\362\177"
	"\011\316\056\216\161\227\042\371\064\253\126\274\313\320\371\163"
	"\045\321\215\116\336\306\347\262\313\074\172\215\214\155\015\226"
	"\073\074\044\255\323\106\247\007\362\376\303\276\317\274\061\364"
	"\216\277\103\154\206\053\037\121\147\232\336\364\007\354\212\103"
	"\050\256\361\373\365\230\002\350\227\306\246\146\203\330\133\021"
	"\074\115\042\336\124\347\366\206\052\150\373\270\222\120\137\172"
	"\150\005\140\013\262\253\273\337\105\111\217\250\273\173\103\347"
	"\236\243\226\240\033\176\307\126\234\260\073\246\112\022\304\246"
	"\063\256\246\367\044\045\164\100\242\254\043\122\105\020\000\304"
	"\355\164\332\000\371\256\071\023\034\267\055\250\045\170\024\160"
	"\222\064\261\067\257\036\274\370\350\143\275\374\025\163\270\023"
	"\323\310\327\337\047\213\177\156\343\204\110\310\044\170\265\061"
	"\153\306\147\063\375\122\326\177\146\227\150\125\217\005\035\035"
	"\105\230\350\326\164\331\307\237\230\056\005\306\134\120\340\173"
	"\264\146\315\205\224\340\065\230\047\202\065\116\037\040\110\102"
	"\356\155\010\200\043\001\077\207\126\114\160\024\156\246\140\172"
	"\154\033\207\272\144\345\142\376\230\107\141\063\144\076\237\267"
	"\033\251\066\073\046\014\102\103\150\207\060\360\207\044\141\067"
	"\201\205\363\233\071\140\057\076\222\123\301\124\227\212\056\166"
	"\360\374\034\113\334\247\076\327\011\361\306\365\026\227\171\165"
	"\155\175\300\035\244\203\320\106\330\302\206\171\270\123\142\122"
	"\331\315\327\252\235\030\223\314\060\246\310\023\144\015\251\033"
	"\215\033\347\215\022\040\313\157\155\004\365\047\334\307\177\336"
	"\021\302\261\242\155\116\112\242\115\230\362\261\102\241\324\172"
	"\200\225\072\102\347\126\152\172\134\155\005\047\316\176\331\215"
	"\152\103\347\250\372\045\165\330\315\152\237\304\132\364\327\225"
	"\074\142\007\030\275\003\214\305\374\007\176\034\113\234\353\042"
	"\050\142\241\062\137\310\366\027\112\226\205\103\332\363\014\165"
	"\371\150\143\362\174\226\106\230\022\236\132\002\263\103\153\005"
	"\225\002\324\072\043\102\232\145\202\014\317\275\322\224\203\250"
	"\070\342\014\076\367\101\261\005\212\137\307\062\012\223\313\250"
	"\035\116\103\004\376\177\014\324\014\202\036\231\134\115\325\265"
	"\166\230\033\374\247\032\344\156\175\242\325\310\364\051\221\332"
	"\004\066\262\037\177\377\367\273\352\223\142\037\075\273\274\347"
	"\234\127\373\272\250\046\246\201\055\354\012\043\061\216\332\346"
	"\257\205\250\125\161\016\135\317\206\317\323\152\203\357\312\177"
	"\063\207\323\156\314\334\043\352\146\163\043\313\013\363\035\014"
	"\235\264\215\177\323\032\024\340\215\003\300\140\303\330\264\072"
	"\100\304\072\033\220\156\357\332\135\066\362\066\052\056\227\070"
	"\116\176\120\052\056\310\160\213\005\334\134\064\247\340\113\275"
	"\016\324\112\376\125\107\015\100\167\143\223\153\332\361\367\123"
	"\350\006\222\143\263\057\123\207\221\160\167\251\340\043\257\122"
	"\134\120\001\163\174\110\246\064\176\072\060\061\223\036\032\051"
	"\210\173\157\303\156\136\214\230\316\150\034\172\274\054\361\206"
	"\261\304\110\365\250\326\334\332\005\122\361\055\302\112\053\304"
	"\006\010\306\372\277\366\263\356\376\165\227\034\330\207\113\344"
	"\217\034\165\201\244\220\056\336\130\153\170\211\341\074\215\323"
	"\055\235\077\154\165\007\206\205\177\252\226\310\200\272\263\313"
	"\162\052\043\150\361\352\035\110\366\004\225\013\307\335\324\306"
	"\377\157\045\236\113\314\064\077\020\224\332\342\362\131\221\307"
	"\016\070\221\310\322\271\124\147\307\344\075\273\175\141\132\314"
	"\216\010\041\204\132\057\150\372\222\235\304\030\246\247\054\304"
	"\031\247\223\272\236\345\257\057\303\226\142\110\375\135\141\105"
	"\206\075\153\132\134\176\314\124\257\223\260\315\262\013\223\220"
	"\044\271\222\314\301\233\263\130\153\250\000\217\051\032\177\325"
	"\077\073\360\302\102\346\301\162\037\211\017\046\070\067\253\306"
	"\315\350\005\222\213\012\117\121\101\263\270\004\226\234\235\371"
	"\042\120\014\063\046\277\372\030\144\343\012\057\323\153\242\371"
	"\137\125\014\347\344\077\007\031\156\054\262\166\261\376\334\111"
	"\263\002\224\370\367\143\166\006\352\012\366\047\052\252\003\074"
	"\360\215\003\112\324\105\245\150\136\132\137\252\007\017\027\171"
	"\156\302\155\352\172\001\235\120\115\371\131\241\047\234\272\257"
	"\044\312\164\327\206\232\162\234\106\116\073\245\034\321\013\376"
	"\343\321\014\275\012\253\204\006\226\073\012\221\374\162\116\306"
	"\321\023\330\306\354\230\146\015\075\067\250\126\114\150\116\234"
	"\137\322\210\050\122\264\270\365\262\232\350\227\012\133\357\263"
	"\202\317\041\255\214\363\352\061\170\321\253\231\320\053\166\365"
	"\364\012\317\245\263\365\250\215\352\307\003\073\156\112\235\316"
	"\360\235\164\361\372\256\350\156\010\033\277\231\367\023\124\163"
	"\325\300\063\336\143\107\152\044\065\042\064\310\224\077\076\105"
	"\320\031\224\024\351\037\321\023\324\326\167\027\003\154\222\231"
	"\263\122\143\235\322\106\174\060\221\250\350\176\251\022\106\005"
	"\366\100\104\140\223\007\136\177\334\274\325\202\272\242\163\045"
	"\022\375\020\352\137\002\360\354\116\227\025\005\375\155\224\305"
	"\310\222\023\120\053\040\113\202\124\101\003\007\162\204\270\051"
	"\123\320\020\267\252\215\222\105\317\154\216\322\072\234\235\377"
	"\125\374\274\344\131\155\333\374\312\307\226\343\054\124\307\263"
	"\076\336\174\301\331\246\172\126\004\211\144\164\203\276\026\041"
	"\114\342\275\273\202\245\027\115\343\350\011\304\041\067\334\121"
	"\000\375\341\315\066\177\343\321\337\070\031\130\133\233\026\251"
	"\317\015\267\263\032\131\314\213\374\077\257\316\277\304\007\052"
	"\333\210\207\270\376\034\130\142\101\153\242\306\256\034\362\273"
	"\021\325\076\252\056\262\376\364\067\302\074\143\201\337\347\271"
	"\352\243\122\317\150\337\150\035\054\226\063\103\363\223\207\246"
	"\026\262\032\175\254\313\235\211\065\032\071\264\061\317\173\120"
	"\337\125\276\300\061\336\020\241\313\161\305\354\372\000\023\005"
	"\334\121\347\167\371\142\053\041\106\154\014\234\251\210\061\203"
	"\055\205\123\303\257\310\057\120\361\060\021\126\214\344\212\040"
	"\170\137\375\130\345\056\121\006\372\006\264\311\053\214\225\327"
	"\311\043\176\014\307\327\253\361\077\063\207\327\226\233\220\322"
	"\075\316\150\175\225\345\160\321\343\174\261\105\374\043\220\245"
	"\333\237\210\265\336\161\053\274\205\332\053\147\345\236\070\221"
	"\044\052\262\117\102\203\065\203\246\166\256\200\057\202\106\245"
	"\021\037\127\211\375\374\076\002\243\255\266\357\004\042\176\073"
	"\307\343\277\165\242\375\202\122\222\372\375\350\150\352\304\176"
	"\142\364\232\264\014\252\173\250\062\034\204\052\164\306\114\252"
	"\037\073\010\376\250\363\100\133\073\023\257\275\362\320\005\141"
	"\123\366\151\057\207\346\140\013\303\325\207\377\062\206\272\153"
	"\125\064\337\134\042\060\003\022\362\010\317\030\273\224\216\113"
	"\276\013\305\067\206\147\261\104\111\130\302\274\332\021\240\214"
	"\065\225\257\215\222\277\031\136\025\336\365\355\031\325\355\256"
	"\205\026\005\250\047\143\074\200\332\324\057\342\201\114\061\160"
	"\316\056\050\340\004\006\225\117\051\132\140\037\257\110\267\036"
	"\135\043\126\216\242\351\300\070\270\250\016\220\300\156\123\153"
	"\135\256\336\142\114\272\123\163\074\174\251\121\211\352\177\246"
	"\106\330\374\156\027\315\053\166\066\273\217\206\163\017\047\231"
	"\151\334\207\324\107\355\060\226\277\177\202\300\341\367\122\370"
	"\270\157\274\154\236\312\260\231\101\034\335\151\021\076\227\160"
	"\024\117\341\334\227\267\117\176\241\042\274\062\127\027\057\226"
	"\351\271\236\032\107\305\011\044\353\245\336\241\216\255\241\275"
	"\367\236\135\114\377\170\236\122\071\053\025\003\014\115\156\271"
	"\206\045\241\003\211\163\217\233\007\162\077\317\175\275\324\365"
	"\004\373\236\272\376\153\323\361\260\230\012\153\135\371\047\320"
	"\015\255\337\275\246\355\305\066\023\122\064\212\347\126\115\203"
	"\227\115\223\002\262\320\105\347\354\043\052\267\250\126\040\107"
	"\367\355\272\000\215\055\312\053\221\324\165\211\006\133\014\016"
	"\174\305\115\261\102\171\324\142\124\207\237\162\232\314\161\200"
	"\020\041\076\116\172\314\313\001\233\016\110\074\361\226\212\024"
	"\353\137\015\344\115\113\155\024\117\207\211\007\314\234\042\017"
	"\034\226\272\056\335\355\100\314\256\371\375\161\251\376\104\154"
	"\014\273\246\070\033\235\211\062\220\324\232\004\055\376\246\155"
	"\120\203\330\176\277\362\262\223\342\250\314\320\007\266\227\236"
	"\176"
#define      msg1_z	42
#define      msg1	((&data[2335]))
	"\157\062\070\116\046\100\072\260\144\053\266\036\135\052\156\147"
	"\255\237\242\350\251\072\002\331\007\124\362\223\163\333\126\122"
	"\156\362\203\171\020\200\370\106\102\261\137\246\022\244\076\050"
	"\077\023\204\143\137\165\136\125"
#define      pswd_z	256
#define      pswd	((&data[2407]))
	"\245\050\343\013\253\273\146\275\123\005\074\161\317\332\340\001"
	"\023\057\047\123\152\330\330\315\356\226\362\266\312\316\034\071"
	"\134\135\002\223\264\375\347\375\121\332\003\263\122\162\202\072"
	"\032\241\237\032\215\306\113\173\134\075\061\046\014\115\140\150"
	"\253\142\374\137\140\344\134\261\276\140\144\020\322\346\113\354"
	"\210\352\007\025\261\122\221\016\220\303\065\234\021\225\005\274"
	"\370\001\033\130\345\170\012\244\330\157\265\253\126\000\230\336"
	"\353\237\364\234\361\205\252\202\110\337\036\131\165\044\026\155"
	"\045\061\306\013\252\320\257\202\077\144\055\225\145\305\164\120"
	"\145\150\354\126\356\227\330\067\166\367\221\353\034\247\131\102"
	"\331\037\115\203\360\375\006\060\141\063\306\307\371\072\027\136"
	"\243\003\265\222\232\216\311\021\206\132\375\242\002\127\344\333"
	"\166\061\136\147\057\145\227\221\230\135\130\222\230\157\361\074"
	"\163\246\316\016\065\230\037\273\362\035\135\365\164\102\320\353"
	"\164\057\123\243\224\352\064\055\110\214\300\341\373\261\035\156"
	"\130\354\175\215\204\234\111\167\272\246\154\057\351\075\033\135"
	"\154\156\000\001\131\064\056\242\301\357\203\274\240\241\053\370"
	"\215\250\206\022\105\317\211\000\067\115\053\214\134\215\312\002"
	"\265\256\016\141\152\164\036"
#define      tst2_z	19
#define      tst2	((&data[2680]))
	"\057\112\207\170\032\127\075\043\353\202\053\057\302\346\031\010"
	"\164\240\044\127\070\065"
#define      date_z	1
#define      date	((&data[2700]))
	"\017"
#define      shll_z	10
#define      shll	((&data[2702]))
	"\251\230\360\162\223\205\015\045\117\110\306\114"
#define      rlax_z	1
#define      rlax	((&data[2713]))
	"\311"
#define      chk2_z	19
#define      chk2	((&data[2717]))
	"\037\060\333\011\057\122\042\023\346\245\062\271\261\064\370\221"
	"\065\004\110\170\017\112"
#define      inlo_z	3
#define      inlo	((&data[2736]))
	"\263\217\353"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !defined(TRACEABLE)

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !defined(TRACEABLE) */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !defined(TRACEABLE)
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
